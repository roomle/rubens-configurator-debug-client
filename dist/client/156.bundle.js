"use strict";(self.webpackChunkconfigurator_debug=self.webpackChunkconfigurator_debug||[]).push([[156],{156:(t,e,n)=>{n.r(e),n.d(e,{DragIn:()=>w});var i=Object.defineProperty,o=(t,e,n)=>((t,e,n)=>e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n)(t,"symbol"!=typeof e?e+"":e,n);class r{constructor(t=16){o(this,"_computedStyleCache",new Map),o(this,"_maxLifetime",16),o(this,"_cacheCleanInterval",null),this._maxLifetime=t}get(t){const e=this._computedStyleCache.get(t),n=Date.now();if(e&&n-e.updated<this._maxLifetime)return e.style;const i=getComputedStyle(t);return this._computedStyleCache.set(t,{style:i,updated:n}),this._cacheCleanInterval||(this._cacheCleanInterval=setInterval((()=>this._cleanUpCache),Math.max(1e3*this._maxLifetime,5e3))),i}_cleanUpCache(){const t=Date.now();for(const[e,{updated:n}]of this._computedStyleCache.entries())t-n>=this._maxLifetime&&this._computedStyleCache.delete(e);0===this._computedStyleCache.size&&this._cacheCleanInterval&&(clearInterval(this._cacheCleanInterval),this._cacheCleanInterval=null)}}const s=t=>window.TouchEvent&&t instanceof window.TouchEvent;let a;const c=t=>(a||(a=new r),a.get(t)),h=(t,e,n)=>{const i=parseFloat(t),o=window.devicePixelRatio||1;if("px"===e)return i;if("%"===e)return i/100*(n===document.documentElement?window.innerWidth:n.offsetWidth);if("rem"===e)return i*parseFloat(c(document.documentElement).fontSize);if("em"===e)return i*parseFloat(c(n).fontSize);if("vh"===e||"vw"===e||"vmin"===e||"vmax"===e)return i/100*{vh:window.innerHeight,vw:window.innerWidth,vmin:Math.min(window.innerWidth,window.innerHeight),vmax:Math.max(window.innerWidth,window.innerHeight)}[e];const r={cm:37.7952755906,mm:3.77952755906,in:96};return e in r?i*r[e]*o:(console.warn("Unable to determine coordinates for drag-in. Therefore drag-in is not possible. Check the CSS that positions the iframe of Roomle"),0)},l=(t,e,n={x:0,y:0})=>{const i=t.getBoundingClientRect(),o=c(t).transform;let r=0,s=0;if("none"!==o){const e=/translate\(\s*([-+]?\d*\.?\d+|\d+)(px|%)?,?\s*([-+]?\d*\.?\d+|\d+)?(px|%)?\s*\)/,n=o.match(e);n&&(r=h(n[1],n[2],t),s=h(n[3],n[4],t))}const{clientX:a,clientY:l}=u(e,n);return{x:a-i.left-r+t.scrollLeft,y:l-i.top-s+t.scrollTop}},u=(t,e)=>{const{clientX:n,clientY:i}=s(t)?d(t):t;return{clientX:n||e.x,clientY:i||e.y}},d=t=>{if(t.touches.length){let{clientX:e,clientY:n}=t.touches[0];if(t.touches.length>1){const i=t.touches[1];e=(e+i.clientX)/2,n=(n+i.clientY)/2}return{clientX:e,clientY:n}}const e=t.changedTouches[0];return{clientX:e.clientX,clientY:e.clientY}};class _{constructor(t,{onTouchDragStart:e},n={}){o(this,"_touchDragTimeOut"),o(this,"_onTouchDragStart"),o(this,"_payload",null),o(this,"_delay",500),o(this,"_firstTouch",null),o(this,"_lastTouch",null),o(this,"_epsilon",10),this._payload=t,this._onTouchDragStart=e,this._delay=n.delay||500,this._epsilon=n.epsilon||10}onTouchStart(t){var e;!t||null==(e=null==t?void 0:t.touches)||!e.length||this._touchDragTimeOut||(this._firstTouch=t.touches[t.touches.length-1],this._touchDragTimeOut=setTimeout((()=>{this._clearTimeout(),this._lastTouch||(this._lastTouch=t.touches[0]),this._checkXDistance(t)()}),this._delay))}onTouchEnd(){this._resetTouches()}onTouchMove(t){var e;!t||null==(e=null==t?void 0:t.touches)||!e.length||(this._lastTouch=t.touches[0])}_clearTimeout(){this._touchDragTimeOut&&(clearTimeout(this._touchDragTimeOut),this._touchDragTimeOut=null)}_resetTouches(){this._clearTimeout(),this._lastTouch=null,this._firstTouch=null,this._payload=null}_checkXDistance(t){return()=>{if(!this._firstTouch||!this._lastTouch)return;let e=!1;e=Math.abs(this._firstTouch.clientX-this._lastTouch.clientX)<this._epsilon,e&&(this._onTouchDragStart(this._payload,t),this._resetTouches())}}}const f="rml-drag-in-styles",g="rml-drag-in-overlay",m="rml-drag-in-drag-ghost",p="rml-drag-in-fade-in",y="rml-drag-in-fade-out",v="rml-display-none",D="250ms",x="forwards",T=t=>!!t||(console.warn("No instance set, cancel drag-in"),!1);class w{constructor(t){o(this,"_iframe"),o(this,"_currentDrag",{}),o(this,"_currentTouch",null),o(this,"_firefoxDragPosition",{x:0,y:0}),o(this,"_instance",null),o(this,"options",{}),o(this,"_firefoxFallback",(t=>{if(!this._currentDrag.event)return;const e=t||window.event;this._firefoxDragPosition.x=e.pageX||0,this._firefoxDragPosition.y=e.pageY||0})),this._iframe=t,this._injectStyles(),this._initializeDragGhost(),this._firefoxFallback=this._firefoxFallback.bind(this),document.addEventListener("dragover",this._firefoxFallback)}_injectStyles(){if(!document.getElementById(f)){const t=document.createElement("style");t.type="text/css",t.id=f,t.innerHTML=`\n        .${v}{display:none}\n        .${g}{position:absolute;top:0;left:0;width:100%;height:100%;z-index:999;}\n        .${m}{position:absolute;top:0;left:0;width:1px;height:1px;z-index:999;pointer-events:none;background-color:transparent;}\n        @keyframes ${p} {from{opacity: 0;}to {opacity: 0.5;}}\n        @keyframes ${y} {from{opacity: 0.5;}to {opacity: 0;}}\n      `,document.head.appendChild(t)}}_initializeDragGhost(){const t=this._iframe.parentNode;let e=t.querySelector("."+m);e||(e=document.createElement("div"),e.classList.add(m),e.innerText=" ",t.appendChild(e))}setInstance(t){this._instance=t}dragStart(t,e,n="rml_id"){const i=this._iframe.parentNode;if("relative"!==c(i).position)return void console.warn("Parent of iframe should have position relative, otherwise drag-in can not detect the x/y coordinates correctly");this._iframe.style.pointerEvents="none";let o=i.querySelector("."+g);o||(o=document.createElement("div"),o.classList.add(g),i.appendChild(o)),o.classList.remove(v),e.target.getAttribute("draggable")||console.warn("Draggable not detected correctly! Did you add draggable=\"true\" to the element? In Sarafi only 'draggable' is too less");const r=i.querySelector("."+m);this._currentDrag.event=e;const s=e.target.cloneNode();s.style.position="fixed",s.style.pointerEvents="none",s.style.opacity="0",s.style.animation=`${p} ${D} ${x}`,s.id="rml-drag-in-drag-element",s.style.zIndex="9999",document.body.appendChild(s),this._currentDrag.element=s;const a=e.target.getBoundingClientRect();this._currentDrag.offset||(this._currentDrag.offset={x:0,y:0});const{clientX:h,clientY:d}=u(e,this._firefoxDragPosition);this._currentDrag.offset.x=h-a.left,this._currentDrag.offset.y=d-a.top,s.style.top=d+"px",s.style.left=h+"px",e instanceof DragEvent&&e.dataTransfer&&e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(r,0,0);const{x:_,y:f}=l(i,this._currentDrag.event||e,this._firefoxDragPosition),y=Math.max(1,_),w=Math.max(1,f);T(this._instance)&&this._instance.dragInObject(t,y,w,n)}dragUpdate(t){var e,n;const i=this._iframe.parentNode,{x:o,y:r}=l(i,t,this._firefoxDragPosition);if(0===o&&0===r)return;const a=Math.max(1,o),c=Math.max(1,r);if(this._currentDrag.element){const{clientX:i,clientY:o}=u(t,this._firefoxDragPosition),r=(null==(e=this._currentDrag.offset)?void 0:e.x)||0,s=(null==(n=this._currentDrag.offset)?void 0:n.y)||0;this._currentDrag.element.style.left=i-r+"px",this._currentDrag.element.style.top=o-s+"px";const h=(this.options.dragInOverlapX||0)+1,l=(this.options.dragInOverlapY||0)+1;this._currentDrag.element.style.animation=a>h&&c>l?`${y} ${D} ${x}`:`${p} ${D} ${x}`}if((1!==a||1!==c)&&T(this._instance)){let e=a,n=c;if(s(t)){const t=this.options.fingerSize||0;e=Math.max(2,a+t),n=Math.max(2,c-t)}this._instance.updateDrag(e,n)}}dragEnd(){this._iframe.style.pointerEvents="all";const t=this._iframe.parentNode;T(this._instance)&&this._instance.dragInObjectEnd(),this._currentDrag.element&&document.body.removeChild(this._currentDrag.element),this._currentDrag={},this._firefoxDragPosition={x:0,y:0};const e=t.querySelector("."+g);e&&e.classList.add(v)}touchStart(t,e,n="rml_id"){var i,o;e.preventDefault();const r={};"number"==typeof(null==(i=this.options)?void 0:i.touchDragDelay)&&(r.delay=this.options.touchDragDelay),null!=(o=this.options)&&o.touchDragEpsilon&&(r.epsilon=this.options.touchDragEpsilon),this._currentTouch=new _(void 0,{onTouchDragStart:(e,i)=>{this.dragStart(t,i,n)}},r),this._currentTouch.onTouchStart(e)}touchMove(t){this._currentTouch&&this._currentTouch.onTouchMove(t),this._currentDrag.event&&this.dragUpdate(t)}touchEnd(){this._currentTouch&&this._currentTouch.onTouchEnd(),this._currentTouch=null,this.dragEnd()}dispose(){document.removeEventListener("dragover",this._firefoxFallback)}}}}]);